Practicum 2:
Part 1
```{r}
img_url <- "https://i.imgur.com/BYvwDan.jpeg"
knitr::include_graphics(img_url)
```
```{r}
library(RSQLite)
#fpath = "D:/Northeastern/DBMS/practicum2/"
fpath = "~/Desktop/CS5200/assignments/"
dbfile = "part1.sqlite"

dbcon <- dbConnect(RSQLite::SQLite(), paste0(fpath, dbfile))
```

```{sql connection=dbcon}
PRAGMA foreign_keys = ON
```
```{sql connection=dbcon}
DROP TABLE IF EXISTS Article;
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Journal;
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS Author;
```

```{sql connection=dbcon}
DROP TABLE IF EXISTS AuthorList;
```

```{sql connection=dbcon}
CREATE TABLE IF NOT EXISTS Article(
PMID VARCHAR(20), 
Title VARCHAR(255),
dateCreated TEXT,
issn VARCHAR(255),
FOREIGN KEY(issn) REFERENCES Journal(issn));
```


```{sql connection=dbcon}
CREATE TABLE IF NOT EXISTS Journal(
issn VARCHAR(255) PRIMARY KEY,
volume INT,
issue INT,
title VARCHAR(255),
pubDate TEXT);
```


```{sql connection=dbcon}
CREATE TABLE IF NOT EXISTS Author(
id INT PRIMARY KEY,
firstName VARCHAR(255),
lastName VARCHAR(255),
initials VARCHAR(5),
affiliation VARCHAR(255));
```


```{sql connection=dbcon}
CREATE TABLE IF NOT EXISTS AuthorList(
id INT PRIMARY KEY,
authorId INT,
articleId VARCHAR(20),
FOREIGN KEY(authorId) REFERENCES Author(id),
FOREIGN KEY(articleId) REFERENCES Article(pmid));
```


```{r}
library(XML)

path <- "~/Desktop/CS5200/"
fn <- "pubmed_sample.xml"
fpn = paste0(path, fn)

xmlObj <- xmlParse(fpn)
```

Author Table fill
```{r}
df <- data.frame(firstname=character(),
                 lastname=character(),
                 initials=character(),
                 affilication=character(),
                 stringsAsFactors=FALSE)
authors <- xpathSApply(xmlObj, "//Author")
dd <- xpathSApply(xmlObj, "count(//LastName)")
print(dd)

for(i in 1:length(authors)) {
  q <- paste("//Author[",i,"]/LastName")
  dd <- xpathSApply(xmlObj, "count(//LastName)")
  node <- xmlNode(q)
  xmlValue(node)
  lastnames <- xmlValue(node, q)
  print(length(lastnames))
  #print(i)
  #print(lastnames)
}
# lastnames <- xpathSApply(xmlObj, "//Author/LastName")
# initials <- xpathSApply(xmlObj, "count(//Author/Initials)")
# affiliations <- xpathSApply(xmlObj, "count(//Author/Affiliation)")
# print(initials)
# print(affiliations)

```

